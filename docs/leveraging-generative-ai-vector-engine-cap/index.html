<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Leveraging AI in SAP with CAP and HANA Cloud&#39;s Vector Engine | Fayaz Mammoo</title>
<meta name="keywords" content="AI, SAP, CAP, HANA Cloud, Vector Engine">
<meta name="description" content="Leveraging AI in SAP with CAP and HANA Cloud&rsquo;s Vector Engine Artificial Intelligence (AI) is the most significant trend in 2024, and for good reason. The possibilities for users leveraging AI are immense, including generating code, AI-supported debugging, image and video generation, text generation, and process automation. Popular AI models like ChatGPT and DALL·E 3 showcase these capabilities. The real question for developers is how to harness the power of these models effectively.">
<meta name="author" content="Fayaz Mammoo">
<link rel="canonical" href="https://rotatingbananas.com/docs/leveraging-generative-ai-vector-engine-cap/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://rotatingbananas.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://rotatingbananas.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://rotatingbananas.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://rotatingbananas.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://rotatingbananas.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://rotatingbananas.com/docs/leveraging-generative-ai-vector-engine-cap/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Leveraging AI in SAP with CAP and HANA Cloud&#39;s Vector Engine" />
<meta property="og:description" content="Leveraging AI in SAP with CAP and HANA Cloud&rsquo;s Vector Engine Artificial Intelligence (AI) is the most significant trend in 2024, and for good reason. The possibilities for users leveraging AI are immense, including generating code, AI-supported debugging, image and video generation, text generation, and process automation. Popular AI models like ChatGPT and DALL·E 3 showcase these capabilities. The real question for developers is how to harness the power of these models effectively." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rotatingbananas.com/docs/leveraging-generative-ai-vector-engine-cap/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2024-05-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-05-28T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Leveraging AI in SAP with CAP and HANA Cloud&#39;s Vector Engine"/>
<meta name="twitter:description" content="Leveraging AI in SAP with CAP and HANA Cloud&rsquo;s Vector Engine Artificial Intelligence (AI) is the most significant trend in 2024, and for good reason. The possibilities for users leveraging AI are immense, including generating code, AI-supported debugging, image and video generation, text generation, and process automation. Popular AI models like ChatGPT and DALL·E 3 showcase these capabilities. The real question for developers is how to harness the power of these models effectively."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Docs",
      "item": "https://rotatingbananas.com/docs/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Leveraging AI in SAP with CAP and HANA Cloud's Vector Engine",
      "item": "https://rotatingbananas.com/docs/leveraging-generative-ai-vector-engine-cap/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Leveraging AI in SAP with CAP and HANA Cloud's Vector Engine",
  "name": "Leveraging AI in SAP with CAP and HANA Cloud\u0027s Vector Engine",
  "description": "Leveraging AI in SAP with CAP and HANA Cloud\u0026rsquo;s Vector Engine Artificial Intelligence (AI) is the most significant trend in 2024, and for good reason. The possibilities for users leveraging AI are immense, including generating code, AI-supported debugging, image and video generation, text generation, and process automation. Popular AI models like ChatGPT and DALL·E 3 showcase these capabilities. The real question for developers is how to harness the power of these models effectively.",
  "keywords": [
    "AI", "SAP", "CAP", "HANA Cloud", "Vector Engine"
  ],
  "articleBody": "Leveraging AI in SAP with CAP and HANA Cloud’s Vector Engine Artificial Intelligence (AI) is the most significant trend in 2024, and for good reason. The possibilities for users leveraging AI are immense, including generating code, AI-supported debugging, image and video generation, text generation, and process automation. Popular AI models like ChatGPT and DALL·E 3 showcase these capabilities. The real question for developers is how to harness the power of these models effectively. While these models are not typically trained on business-specific domains and may produce inaccuracies or “hallucinations,” understanding and mitigating these limitations can unlock their full potential.\nUnderstanding AI Hallucinations AI hallucinations are incorrect or misleading results generated by AI models. These errors can be caused by a variety of factors, including insufficient training data, incorrect assumptions made by the model, or biases in the data used to train the model. According to Google Cloud, these hallucinations can be mitigated by extending the knowledge of the Large Language Model (LLM) with information about the context of our business domain.\nOne effective way to do this is by using vector embeddings.\nVector Embeddings and SAP HANA Cloud’s Vector Engine Vector embeddings are mathematical representations used to encode objects into multi-dimensional vector space. These embeddings capture the relationships and similarities between objects. The SAP HANA Cloud Vector Engine facilitates the storage and analysis of complex and unstructured vector data (embeddings) into a format that can be seamlessly processed, compared, and utilized in building various intelligent data applications and adding more context in case of GenAI scenarios.\nUsing the SAP HANA Cloud’s Vector Engine is a convenient way for SAP Developers to create context for the AI models provided by SAP Core AI. SAP HANA Cloud is already part of the SAP ecosystem, making integration easier. SAP offers LLMs through the use of SAP’s partner foundation models, providing all the tools needed to add context to an LLM like GPT-4.\nWith an LLM and the right contextual embeddings, a developer can build an application consuming the model’s capabilities, exposing features or APIs that allow for meaningful business software to improve user and developer experience.\nSteps to Implement Create an instance of SAP AI Core. Create deployments for a model supporting ChatCompletion (e.g., gpt-35-turbo or gpt-4) and an embedding model (text-embedding-ada-002). Establish a connection to SAP AI Core via Destination Services. Create SAP HANA Cloud with Vector Engine (QRC 1/2024 or later). Implement the CAP service using the CAP LLM Plugin (Beta). Create an input document to create the contextual data in the form of vector embeddings. Create and store vector embeddings for SAP HANA Cloud Vector Engine. Send the RAG request with the needed vector embeddings to the AI model within SAP AI Core. Enjoy the response! Architecture Overview A CAP application is connected to an SAP HANA Cloud instance on the SAP Business Technology Platform (BTP). The application interacts with the SAP HANA Cloud Vector Engine. The CAP LLM Plugin used within the application executes AI-specific tasks on the SAP AI Core services. The connection to the SAP AI Core goes through BTP’s destination service. SAP AI Core routes the requests through to the partner foundation models, such as Azure OpenAI Services, and sends back the response.\nCAP LLM Plugin Within the CAP service, the CAP LLM Plugin can be used not only to connect to the SAP AI Core or SAP HANA Cloud Vector Engine but also to execute operations like anonymization of data, creation of embeddings, executing similarity search, chat completion, and RAG responses. The plugin is available as an npm package, with documentation and samples available on GitHub (currently in beta and not suitable for production use cases yet).\nConfiguration and Connection The .cdsrc.json file is used for configuring which embedding and chat models the CAP LLM Plugin can connect to via the SAP AI Core.\n{ \"GENERATIVE_AI_HUB\": { \"CHAT_MODEL_DESTINATION_NAME\": \"\", \"CHAT_MODEL_DEPLOYMENT_URL\": \"\", \"CHAT_MODEL_RESOURCE_GROUP\": \"\", \"CHAT_MODEL_API_VERSION\": \"\", \"EMBEDDING_MODEL_DESTINATION_NAME\": \"\", \"EMBEDDING_MODEL_DEPLOYMENT_URL\": \"\", \"EMBEDDING_MODEL_RESOURCE_GROUP\": \"\", \"EMBEDDING_MODEL_API_VERSION\": \"\" }, \"AICoreAzureOpenAIDestination\": { \"kind\": \"rest\", \"credentials\": { \"destination\": \"\", \"requestTimeout\": \"300000\" } } } Preparing Input Data for Vector Embeddings By default, none of the partner foundation models know anything about our specific business domain. That means we have to train the model on any relevant context information needed for a successful response. The relevant information can be fed through vector embeddings to the model so it will understand and learn the context of the business case. The information can be provided through a simple text document which gets chunked and sent to the SAP AI Core to create the needed vector embeddings. These are then stored in the vector engine database of an SAP HANA Cloud instance.\nBefore creating the embeddings and training the model, it’s interesting to see what the model returns on a question on a recent event. Let’s ask the model about a recent event in May 2024. The response will most likely be a hallucination or it can’t be answered at all:\n{ \"@odata.context\": \"$metadata#Edm.String\", \"value\": { \"completion\": { \"content\": \"I'm sorry, but I cannot provide the recent info. If you have any other questions, feel free to ask!\", \"role\": \"assistant\" }, \"additionalContents\": [] } } In the CAP application code, the LangChain Text Loader and Recursive Character Text Splitter are used to read and chunk the text file:\nconst { TextLoader } = require('langchain/document_loaders/fs/text') const { RecursiveCharacterTextSplitter } = require('langchain/text_splitter') let textChunkEntries = [] const loader = new TextLoader(path.resolve('path/input.txt')) const document = await loader.load() const splitter = new RecursiveCharacterTextSplitter({ chunkSize: 500, chunkOverlap: 0, addStartIndex: true }) const textChunks = await splitter.splitDocuments(document) The input text file is an excerpt of the recent event. The resulting text chunks are sent to SAP AI Core via the CAP LLM Plugin. The embedding API retrieves the embeddings based on the text chunks, which are then written into an object in the form of a vector and inserted into the database:\ntry { const vectorPlugin = await cds.connect.to('cap-llm-plugin') for (const chunk of textChunks) { const embedding = await vectorPlugin.getEmbedding(chunk.pageContent) const entry = { \"text_chunk\": chunk.pageContent, \"metadata_column\": loader.filePath, \"embedding\": array2VectorBuffer(embedding) } textChunkEntries.push(entry) } const insertStatus = await INSERT.into(DocumentChunk).entries(textChunkEntries) if (!insertStatus) { throw new Error(\"Insertion of text chunks into db failed!\") } return `Embeddings stored successfully to db.` } catch (error) { console.log('Error while generating and storing vector embeddings:', error) throw error } The database table containing the text chunks will look something like this:\n{ \"@odata.context\": \"$metadata#DocumentChunk\", \"value\": [ { \"text_chunk\": \"Welcome to the SAP Innovation Day, an extraordinary convergence of cutting-edge technology and visionary insights set against the backdrop of Dubai's awe-inspiring Museum of the Future.\", \"metadata_column\": null }, { \"text_chunk\": \"At SAP, we believe in harnessing the power of AI to drive better business outcomes, and this event is dedicated to showcasing how AI can be seamlessly integrated into your business solutions\": null }, { \"text_chunk\": \", empowering you to unlock unprecedented levels of innovation, efficiency, and growth.\", \"metadata_column\": null }, { \"text_chunk\": \"Under the theme - AI Everywhere For Better Business Outcomes\", \"metadata_column\": null } ] } It’s helpful to implement a helper service within your CAP service application to store and delete embeddings, making experimentation easier.\nservice EmbeddingStorageService { entity DocumentChunk as projection on db.DocumentChunk excluding { embedding }; function storeEmbeddings() returns String; function deleteEmbeddings() returns String; } Using the CAP LLM Plugin for the RAG Response The embedding vectors are stored, and the connection to the LLM model is set. The last piece is to implement the application serving the RAG response to the user’s question.\nThe CAP application defines an OData function that can be called via the service’s API:\nservice RoadshowService { function getRagResponse() returns String; function executeSimilaritySearch() returns String; } The implementation uses the CAP LLM Plugin’s APIs to execute the requests:\nconst cds = require('@sap/cds') const tableName = 'SAP_ADVOCATES_DEMO_DOCUMENTCHUNK' const embeddingColumn = 'EMBEDDING' const contentColumn = 'TEXT_CHUNK' const userQuery = 'In which city is the SAP Innovation Day held?' module.exports = function() { this.on('getRagResponse', async () =\u003e { try { const vectorplugin = await cds.connect.to('cap-llm-plugin') const ragResponse = await vectorplugin.getRagResponse( userQuery, tableName, embeddingColumn, contentColumn ) return ragResponse } catch (error) { console.log('Error while generating response for user query:', error) throw error; } }) this.on('executeSimilaritySearch', async () =\u003e { const vectorplugin = await cds.connect.to('cap-llm-plugin') const embeddings = await vectorplugin.getEmbedding(userQuery) const similaritySearchResults = await vectorplugin.similaritySearch( tableName, embeddingColumn, contentColumn, embeddings, 'L2DISTANCE', 3 ) return similaritySearchResults }) } The call for the RAG response expects the user query, the table name for the text chunks, the column where the embeddings are stored, and the content column. The response contains the LLM’s response to the user’s question. After the model knows the context of the event, it will most likely answer with the correct information.\nConclusion I hope this blog post helps you understand how to enhance the AI models behind SAP AI Core with embeddings using the SAP HANA Cloud Vector Engine and the CAP LLM Plugin. Visit the CAP LLM Plugin. for more samples.\nHappy coding!\n",
  "wordCount" : "1491",
  "inLanguage": "en",
  "datePublished": "2024-05-28T00:00:00Z",
  "dateModified": "2024-05-28T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Fayaz Mammoo"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://rotatingbananas.com/docs/leveraging-generative-ai-vector-engine-cap/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Fayaz Mammoo",
    "logo": {
      "@type": "ImageObject",
      "url": "https://rotatingbananas.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://rotatingbananas.com/" accesskey="h" title="Fayaz Mammoo (Alt + H)">Fayaz Mammoo</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Leveraging AI in SAP with CAP and HANA Cloud&#39;s Vector Engine
    </h1>
    <div class="post-meta"><span title='2024-05-28 00:00:00 +0000 UTC'>May 28, 2024</span>&nbsp;·&nbsp;Fayaz Mammoo

</div>
  </header> 
  <div class="post-content"><h3 id="leveraging-ai-in-sap-with-cap-and-hana-clouds-vector-engine">Leveraging AI in SAP with CAP and HANA Cloud&rsquo;s Vector Engine<a hidden class="anchor" aria-hidden="true" href="#leveraging-ai-in-sap-with-cap-and-hana-clouds-vector-engine">#</a></h3>
<p>Artificial Intelligence (AI) is the most significant trend in 2024, and for good reason. The possibilities for users leveraging AI are immense, including generating code, AI-supported debugging, image and video generation, text generation, and process automation. Popular AI models like ChatGPT and DALL·E 3 showcase these capabilities. The real question for developers is how to harness the power of these models effectively. While these models are not typically trained on business-specific domains and may produce inaccuracies or &ldquo;hallucinations,&rdquo; understanding and mitigating these limitations can unlock their full potential.</p>
<h3 id="understanding-ai-hallucinations">Understanding AI Hallucinations<a hidden class="anchor" aria-hidden="true" href="#understanding-ai-hallucinations">#</a></h3>
<p>AI hallucinations are incorrect or misleading results generated by AI models. These errors can be caused by a variety of factors, including insufficient training data, incorrect assumptions made by the model, or biases in the data used to train the model. According to Google Cloud, these hallucinations can be mitigated by extending the knowledge of the Large Language Model (LLM) with information about the context of our business domain.</p>
<p>One effective way to do this is by using vector embeddings.</p>
<h3 id="vector-embeddings-and-sap-hana-clouds-vector-engine">Vector Embeddings and SAP HANA Cloud&rsquo;s Vector Engine<a hidden class="anchor" aria-hidden="true" href="#vector-embeddings-and-sap-hana-clouds-vector-engine">#</a></h3>
<p>Vector embeddings are mathematical representations used to encode objects into multi-dimensional vector space. These embeddings capture the relationships and similarities between objects. The SAP HANA Cloud Vector Engine facilitates the storage and analysis of complex and unstructured vector data (embeddings) into a format that can be seamlessly processed, compared, and utilized in building various intelligent data applications and adding more context in case of GenAI scenarios.</p>
<p>Using the SAP HANA Cloud&rsquo;s Vector Engine is a convenient way for SAP Developers to create context for the AI models provided by SAP Core AI. SAP HANA Cloud is already part of the SAP ecosystem, making integration easier. SAP offers LLMs through the use of SAP&rsquo;s partner foundation models, providing all the tools needed to add context to an LLM like GPT-4.</p>
<p>With an LLM and the right contextual embeddings, a developer can build an application consuming the model&rsquo;s capabilities, exposing features or APIs that allow for meaningful business software to improve user and developer experience.</p>
<h3 id="steps-to-implement">Steps to Implement<a hidden class="anchor" aria-hidden="true" href="#steps-to-implement">#</a></h3>
<ol>
<li><strong>Create an instance of SAP AI Core.</strong></li>
<li><strong>Create deployments for a model supporting ChatCompletion (e.g., gpt-35-turbo or gpt-4) and an embedding model (text-embedding-ada-002).</strong></li>
<li><strong>Establish a connection to SAP AI Core via Destination Services.</strong></li>
<li><strong>Create SAP HANA Cloud with Vector Engine (QRC 1/2024 or later).</strong></li>
<li><strong>Implement the CAP service using the CAP LLM Plugin (Beta).</strong></li>
<li><strong>Create an input document to create the contextual data in the form of vector embeddings.</strong></li>
<li><strong>Create and store vector embeddings for SAP HANA Cloud Vector Engine.</strong></li>
<li><strong>Send the RAG request with the needed vector embeddings to the AI model within SAP AI Core.</strong></li>
<li><strong>Enjoy the response!</strong></li>
</ol>
<h3 id="architecture-overview">Architecture Overview<a hidden class="anchor" aria-hidden="true" href="#architecture-overview">#</a></h3>
<p>A CAP application is connected to an SAP HANA Cloud instance on the SAP Business Technology Platform (BTP). The application interacts with the SAP HANA Cloud Vector Engine. The CAP LLM Plugin used within the application executes AI-specific tasks on the SAP AI Core services. The connection to the SAP AI Core goes through BTP&rsquo;s destination service. SAP AI Core routes the requests through to the partner foundation models, such as Azure OpenAI Services, and sends back the response.</p>
<h3 id="cap-llm-plugin">CAP LLM Plugin<a hidden class="anchor" aria-hidden="true" href="#cap-llm-plugin">#</a></h3>
<p>Within the CAP service, the CAP LLM Plugin can be used not only to connect to the SAP AI Core or SAP HANA Cloud Vector Engine but also to execute operations like anonymization of data, creation of embeddings, executing similarity search, chat completion, and RAG responses. The plugin is available as an npm package, with documentation and samples available on GitHub (currently in beta and not suitable for production use cases yet).</p>
<h3 id="configuration-and-connection">Configuration and Connection<a hidden class="anchor" aria-hidden="true" href="#configuration-and-connection">#</a></h3>
<p>The <code>.cdsrc.json</code> file is used for configuring which embedding and chat models the CAP LLM Plugin can connect to via the SAP AI Core.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;GENERATIVE_AI_HUB&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;CHAT_MODEL_DESTINATION_NAME&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;CHAT_MODEL_DEPLOYMENT_URL&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;CHAT_MODEL_RESOURCE_GROUP&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;CHAT_MODEL_API_VERSION&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;EMBEDDING_MODEL_DESTINATION_NAME&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;EMBEDDING_MODEL_DEPLOYMENT_URL&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;EMBEDDING_MODEL_RESOURCE_GROUP&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;EMBEDDING_MODEL_API_VERSION&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;AICoreAzureOpenAIDestination&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;kind&#34;</span>: <span style="color:#e6db74">&#34;rest&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;credentials&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;destination&#34;</span>: <span style="color:#e6db74">&#34;&lt;destination name&gt;&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;requestTimeout&#34;</span>: <span style="color:#e6db74">&#34;300000&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="preparing-input-data-for-vector-embeddings">Preparing Input Data for Vector Embeddings<a hidden class="anchor" aria-hidden="true" href="#preparing-input-data-for-vector-embeddings">#</a></h3>
<p>By default, none of the partner foundation models know anything about our specific business domain. That means we have to train the model on any relevant context information needed for a successful response. The relevant information can be fed through vector embeddings to the model so it will understand and learn the context of the business case. The information can be provided through a simple text document which gets chunked and sent to the SAP AI Core to create the needed vector embeddings. These are then stored in the vector engine database of an SAP HANA Cloud instance.</p>
<p>Before creating the embeddings and training the model, it&rsquo;s interesting to see what the model returns on a question on a recent event. Let&rsquo;s ask the model about a recent event in May 2024. The response will most likely be a hallucination or it can&rsquo;t be answered at all:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;@odata.context&#34;</span>: <span style="color:#e6db74">&#34;$metadata#Edm.String&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;value&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;completion&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;content&#34;</span>: <span style="color:#e6db74">&#34;I&#39;m sorry, but I cannot provide the recent info. If you have any other questions, feel free to ask!&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;role&#34;</span>: <span style="color:#e6db74">&#34;assistant&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;additionalContents&#34;</span>: []
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In the CAP application code, the LangChain Text Loader and Recursive Character Text Splitter are used to read and chunk the text file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">TextLoader</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;langchain/document_loaders/fs/text&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">RecursiveCharacterTextSplitter</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;langchain/text_splitter&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">textChunkEntries</span> <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">loader</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">TextLoader</span>(<span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#e6db74">&#39;path/input.txt&#39;</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> document <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">loader</span>.<span style="color:#a6e22e">load</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">splitter</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">RecursiveCharacterTextSplitter</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">chunkSize</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">500</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">chunkOverlap</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">addStartIndex</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">textChunks</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">splitter</span>.<span style="color:#a6e22e">splitDocuments</span>(document)
</span></span></code></pre></div><p>The input text file is an excerpt of the recent event. The resulting text chunks are sent to SAP AI Core via the CAP LLM Plugin. The embedding API retrieves the embeddings based on the text chunks, which are then written into an object in the form of a vector and inserted into the database:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">vectorPlugin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">cds</span>.<span style="color:#a6e22e">connect</span>.<span style="color:#a6e22e">to</span>(<span style="color:#e6db74">&#39;cap-llm-plugin&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">chunk</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">textChunks</span>) {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">embedding</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">vectorPlugin</span>.<span style="color:#a6e22e">getEmbedding</span>(<span style="color:#a6e22e">chunk</span>.<span style="color:#a6e22e">pageContent</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">entry</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>           <span style="color:#e6db74">&#34;text_chunk&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">chunk</span>.<span style="color:#a6e22e">pageContent</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#e6db74">&#34;metadata_column&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">loader</span>.<span style="color:#a6e22e">filePath</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#e6db74">&#34;embedding&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">array2VectorBuffer</span>(<span style="color:#a6e22e">embedding</span>)
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">textChunkEntries</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">entry</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">insertStatus</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">INSERT</span>.<span style="color:#a6e22e">into</span>(<span style="color:#a6e22e">DocumentChunk</span>).<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">textChunkEntries</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">insertStatus</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Insertion of text chunks into db failed!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`Embeddings stored successfully to db.`</span>
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Error while generating and storing vector embeddings:&#39;</span>, <span style="color:#a6e22e">error</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#a6e22e">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The database table containing the text chunks will look something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;@odata.context&#34;</span>: <span style="color:#e6db74">&#34;$metadata#DocumentChunk&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;value&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;text_chunk&#34;</span>: <span style="color:#e6db74">&#34;Welcome to the SAP Innovation Day, an extraordinary convergence of cutting-edge technology and visionary insights set against the backdrop of Dubai&#39;s awe-inspiring Museum of the Future.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;metadata_column&#34;</span>: <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;text_chunk&#34;</span>: <span style="color:#e6db74">&#34;At SAP, we believe in harnessing the power of AI to drive better business outcomes, and this event is dedicated to showcasing how AI can be seamlessly integrated into your business solutions&#34;</span>: <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;text_chunk&#34;</span>: <span style="color:#e6db74">&#34;, empowering you to unlock unprecedented levels of innovation, efficiency, and growth.&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;metadata_column&#34;</span>: <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;text_chunk&#34;</span>: <span style="color:#e6db74">&#34;Under the theme - AI Everywhere For Better Business Outcomes&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;metadata_column&#34;</span>: <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>It&rsquo;s helpful to implement a helper service within your CAP service application to store and delete embeddings, making experimentation easier.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">service</span> <span style="color:#a6e22e">EmbeddingStorageService</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">entity</span> <span style="color:#a6e22e">DocumentChunk</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">projection</span> <span style="color:#a6e22e">on</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">DocumentChunk</span> <span style="color:#a6e22e">excluding</span> { <span style="color:#a6e22e">embedding</span> };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">storeEmbeddings</span>() <span style="color:#a6e22e">returns</span> String;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">deleteEmbeddings</span>() <span style="color:#a6e22e">returns</span> String;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="using-the-cap-llm-plugin-for-the-rag-response">Using the CAP LLM Plugin for the RAG Response<a hidden class="anchor" aria-hidden="true" href="#using-the-cap-llm-plugin-for-the-rag-response">#</a></h3>
<p>The embedding vectors are stored, and the connection to the LLM model is set. The last piece is to implement the application serving the RAG response to the user&rsquo;s question.</p>
<p>The CAP application defines an OData function that can be called via the service&rsquo;s API:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">service</span> <span style="color:#a6e22e">RoadshowService</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getRagResponse</span>() <span style="color:#a6e22e">returns</span> String;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">executeSimilaritySearch</span>() <span style="color:#a6e22e">returns</span> String;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The implementation uses the CAP LLM Plugin&rsquo;s APIs to execute the requests:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cds</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;@sap/cds&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tableName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;SAP_ADVOCATES_DEMO_DOCUMENTCHUNK&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">embeddingColumn</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;EMBEDDING&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">contentColumn</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;TEXT_CHUNK&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">userQuery</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;In which city is the SAP Innovation Day held?&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;getRagResponse&#39;</span>, <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">vectorplugin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">cds</span>.<span style="color:#a6e22e">connect</span>.<span style="color:#a6e22e">to</span>(<span style="color:#e6db74">&#39;cap-llm-plugin&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ragResponse</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">vectorplugin</span>.<span style="color:#a6e22e">getRagResponse</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">userQuery</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">tableName</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">embeddingColumn</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">contentColumn</span>
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ragResponse</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Error while generating response for user query:&#39;</span>, <span style="color:#a6e22e">error</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#a6e22e">error</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;executeSimilaritySearch&#39;</span>, <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">vectorplugin</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">cds</span>.<span style="color:#a6e22e">connect</span>.<span style="color:#a6e22e">to</span>(<span style="color:#e6db74">&#39;cap-llm-plugin&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">embeddings</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">vectorplugin</span>.<span style="color:#a6e22e">getEmbedding</span>(<span style="color:#a6e22e">userQuery</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">similaritySearchResults</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">vectorplugin</span>.<span style="color:#a6e22e">similaritySearch</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">tableName</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">embeddingColumn</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">contentColumn</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">embeddings</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;L2DISTANCE&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">similaritySearchResults</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The call for the RAG response expects the user query, the table name for the text chunks, the column where the embeddings are stored, and the content column. The response contains the LLM&rsquo;s response to the user&rsquo;s question. After the model knows the context of the event, it will most likely answer with the correct information.</p>
<h3 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h3>
<p>I hope this blog post helps you understand how to enhance the AI models behind SAP AI Core with embeddings using the SAP HANA Cloud Vector Engine and the CAP LLM Plugin. Visit the <a href="https://www.npmjs.com/package/cap-llm-plugin?activeTab=readme">CAP LLM Plugin</a>. for more samples.</p>
<p>Happy coding!</p>
<pre tabindex="0"><code></code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://rotatingbananas.com/tags/ai/">AI</a></li>
      <li><a href="https://rotatingbananas.com/tags/sap/">SAP</a></li>
      <li><a href="https://rotatingbananas.com/tags/cap/">CAP</a></li>
      <li><a href="https://rotatingbananas.com/tags/hana-cloud/">HANA Cloud</a></li>
      <li><a href="https://rotatingbananas.com/tags/vector-engine/">Vector Engine</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://rotatingbananas.com/">Fayaz Mammoo</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
